# Crypto Trading Analyse- & Backtesting-Framework (Stand 250805)

## Projektziel
Wissenschaftlich fundiertes, modular aufgebautes Analyse- und Trading-Framework für Krypto-Strategien mit:
- automatisierter Analyse, Optimierung, Blindtest & Backtesting
- interaktiver Visualisierung (Plotly HTML mit Trade-Markern, Verbindungslinien, Equity-Kurve)
- universellen Exporten (Excel, CSV, HTML) für Forschung, Dokumentation und Automatisierung

---

## Features (Stand eingefroren)
### Datenhandling & Indikatoren
- Import beliebiger Assets (z. B. BTC, ETH, XRP, XLM, …) und Zeitfrequenzen (1h, 1d, 5m …) aus Parquet-Dateien
- Automatische Erkennung der Rohdaten-Dateien im Verzeichnis:
  - Assetname und Datenfrequenz werden automatisch erkannt
  - Interaktive Auswahl einer Datei
- Timestamp-Fallback:
  - Falls keine timestamp-Spalte vorhanden → Erzeugung aus Index, date-Spalte oder Dummy-Datetime
- Indikatoren (immer automatisch):
  - EMA50, EMA200, EMA20
  - MACD (12/26)
  - ATR (14)
  - Bollinger-Bänder (BB_Upper, BB_Lower, BB_Width)
  - RSI (14)
  - MFI (14)
  - VWAP
  - Heikin-Ashi (Open/Close)
  - ADX (14)
- Robuste Fallbacks: fehlende Spalten werden automatisch ergänzt (Dummywerte oder neu berechnet)

### Strategien & Regime
- Mehrere Strategien implementiert:
  - Bollinger-Ausbruch, VWAP-Breakout, Always-Trade
- Marktregime-Erkennung:
  - uptrend / downtrend / sideways
  - breakout / squeeze
  - überkauft / überverkauft
- Signal-Generierung:
  - Score-basierte Meta-Signale
  - Kombination mehrerer Indikatoren und Strategien
- Trennung von Optimierung & Blindtest:
  - Parameter (min. Score usw.) aus `best_params.json`
  - Blindtests verwenden keine Optimierungsdaten

### Trade-Engine
- Meta-Strategie mit Indikatoren:
  - Einstieg: Signal + Tradefrequenz-Filter
  - Ausstieg: Stop-Loss, Take-Profit, Max-Haltedauer
- Kapital-Management:
  - Startkapital (Standard 10.000)
  - Positionsgröße: 10 % vom Kapital (min. 1)
  - Stop-Loss (–5 %), Take-Profit (+20 %)
- Speicherung aller relevanten Trade-Infos:
  - Entry/Exit Zeit, Preise, Regime, Score, Indikatorwerte am Entry, Dauer, Grund des Exits, PnL absolut und in %, Kapitalverlauf
- Trades als Excel & CSV → komplett reproduzierbar

### Visualisierung
- Zwei-Panel Plot (Plotly):
  - Oben: Kursverlauf mit Entry/Exit-Markern
    - Marker-Beschriftung: nur Trade-ID (Nummer)
    - Hoverinfo: ausführlich (Entry/Exit-Infos, Regime, Score, Trigger, PnL, Dauer, SL/TP-Hit)
    - Entry→Exit-Linien (schwarze gestrichelte Verbindungslinien)
  - Unten: Equity-Kurve
    - Equity-Marker mit Trade-ID als Text und ausführlicher Hoverinfo (PnL, Equity nach Trade)
- Performance-Box im Plot:
  - Anzahl Trades, Gesamt-PnL, Durchschnitts-PnL, Winrate, Start- und Endkapital, Max Drawdown
- HTML-Export: `<ASSET>_Equity_Backtest.html`

### Performance-Auswertung
- Kennzahlen (Terminal + Box im Plot):
  - Anzahl Trades, Gesamt-PnL, Durchschnittlicher PnL, Winrate, Startkapital/Endkapital, Max Drawdown

### Modularisierung
- `tradingmodule_250805a.py` (Hauptskript)
- `mod_data.py` (Datei-Scan, Datenauswahl, timestamp-Erzeugung)
- `mod_indicators.py` (Indikatorberechnung mit robusten Fallbacks)
- `mod_strategy.py` (Regime-Erkennung, Signal-Generierung)
- `mod_trades.py` (Trade-Engine mit Entry/Exit-Logik)
- `mod_plots.py` (Plot mit Marker, Verbindungslinien, Equity-Kurve und Performance-Box)
- `mod_utils.py` (Hilfsfunktionen)

---

## Ergebnisse
- Trades: Excel & CSV im `results/` Verzeichnis
- Interaktive Charts: HTML mit Marker & Hoverinfos
- Terminalausgabe: Backtest-Performance, Debug-Informationen

---

## Gefrorener Status
- Alle Features implementiert
- Keine bekannten Bugs
- Letzte Fixes:
  - timestamp-Fallback
  - Max-Drawdown-Formatierung
  - HTML-Export-Sicherheit
  - Marker/Verbindungslinien
  - Equity-Marker mit Hoverinfos
- Getestet mit **XLMUSDT (1h, 1 Jahr)**: 110 Trades → HTML erfolgreich erzeugt, Performance-Box im Plot

---

## Setup & Nutzung
### 1. Repository klonen
```bash
git clone <dein_repo_url>.git
cd <repo_name>
